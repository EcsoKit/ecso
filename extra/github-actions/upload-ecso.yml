- name: Generate readme (Unix)
  if: ${{ !startsWith(env.PLATFORM, 'windows') }}
  run: ./haxe --cwd plugins/ecso/extra/readme build-::README_ID::.hxml

- name: Generate readme (Windows)
  if: ${{ startsWith(env.PLATFORM, 'windows') }}
  run: ./haxe.exe --cwd plugins/ecso/extra/readme build-::README_ID::.hxml

- name: . . . push readme (github)
  if: ${{ '::README_ID::' == 'github' }}
  run: |
    git commit -m "update readme" plugins/ecso/README.md
    git push

- name: Upload Ecso
  uses: actions/upload-artifact@v2
  with:
    name: ecso
    path: plugins/ecso/**/*.cmxs
    if-no-files-found: error

- uses: actions/upload-artifact@v2
  with:
    name: ecso
    path: |
      plugins/ecso/*/ecso/*.hx
      plugins/ecso/*/ecso/_core/*.hx
    if-no-files-found: error

- uses: actions/upload-artifact@v2
  with:
    name: ecso
    path: plugins/ecso/README.md
    if-no-files-found: error

- uses: actions/upload-artifact@v2
  with:
    name: ecso
    path: plugins/ecso/LICENSE.md
    if-no-files-found: error

- uses: actions/upload-artifact@v2
  with:
    name: ecso
    path: plugins/ecso/extraParams.hxml
    if-no-files-found: error

- uses: actions/upload-artifact@v2
  with:
    name: ecso
    path: plugins/ecso/haxelib.json
    if-no-files-found: error